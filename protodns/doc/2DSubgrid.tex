\documentclass[11pt,a4paper]{article}
\usepackage{amsmath}
\usepackage{amsfonts}
\usepackage{cancel}
\usepackage[colorlinks]{hyperref}
\hypersetup{
    colorlinks=true,
    citecolor = blue,
    linkcolor = red
}
\usepackage{amssymb}
\usepackage{graphicx}
\usepackage[left=2cm,right=2cm,top=2cm,bottom=2cm]{geometry}
\newcommand{\eq}[1]{(\ref{#1})}
\author{Noel Murasko}
\title{Two-Dimensional Large Eddy Simulation}
\date{\today}
\begin{document}
\maketitle
\noindent 
\section{Filtering Equations}
Recall that direct numerical simulation of the `small scales' is too computationally expensive. In Large Eddy Simulations, aim to simulate only the large scales. This can be done formally by filtering our equations \cite{Leonard1974}. Consider some function $f(\boldsymbol{x}, t)$. The ``large scales'' of $f$ can be obtained by a convolution with a filter function $G$:
$$\overline{f} = \int G(\boldsymbol{x} - \boldsymbol{x}')f(\boldsymbol{x}')\ d\boldsymbol{x}'.$$
The filter function $G$ has an associated length scale $\Delta$. Scales smaller than $\Delta$ are removed in $\overline{f}$. 

Assuming the fluid is incompressible, we can express the Navier--Stokes equation and continuity equation in terms of their components:
$$\frac{\partial u_i}{\partial t} - \frac{\partial }{\partial x_j}(u_iu_j)+\frac{\partial P}{\partial x_i}- \nu \frac{\partial^2u_i}{\partial x_j^2} = F_i,$$
$$\frac{\partial u_i}{\partial x_i}  =0.$$
Here, $P$ is the pressure, $u_i$ is the velocity in the $i$th direction, and $F_i$ is the external force in the $i$th direction. Note that we use Einstein notation and sum over repeated indices. Applying a filter to these equations gives us:
$$\frac{\partial \overline{u}_i}{\partial t} - \frac{\partial }{\partial x_j}\left(\overline{u_iu_j}\right)+\frac{\partial \overline{P}}{\partial x_i}- \nu \frac{\partial^2\overline{u}_i}{\partial x_j^2}= \overline{F}_i,$$
$$\frac{\partial \overline{u}_i}{\partial x_i}  =0.$$
The difficulty of this equation is the nonlinear term $\left(\overline{u_iu_j}\right)$ which is the filtered product of the unfiltered velocities. We can't compute this term directly; we need a model for it.

To formulate such a model, we define the residual stress tensor as the difference between the filtered product of velocities and the product of filtered velocities \cite{Pope2000}:
$$\tau_{ij}^R := \overline{u_iu_j} - \overline{u}_i\overline{u}_j.$$
$\tau_{ij}^R$ is called the \emph{residual stress tensor}. Now we can write the non-linear term as:
$$\overline{u_iu_j} = \overline{u}_i\overline{u}_j+\tau_{ij}^R.$$
Substituting this into the filtered Navier--Stokes equation gives us
$$\frac{\partial \overline{u}_i}{\partial t} - \frac{\partial }{\partial x_j}\left(\overline{u}_i\overline{u}_j+\tau_{ij}^R \right)+\frac{\partial \overline{P}}{\partial x_i}- \nu \frac{\partial^2\overline{u}_i}{\partial x_j^2} = \overline{F}_i.$$
We make an additional simplification as follows: define the \emph{anisotropic stress tensor} as
$$\tau_{ij}^r := \tau_{ij}^R - \frac{1}{3}\delta_{ij}\tau_{kk}^R,$$
and the modified filtered pressure as
$$\overline{p} := \overline{P} - \frac{1}{3}\delta_{ij}\tau_{kk}^R.$$
Then we can express the filtered Navier--Stokes equation as
\begin{equation}\label{barsNS}
\frac{\partial \overline{u}_i}{\partial t} - \frac{\partial }{\partial x_j}\left(\overline{u}_i\overline{u}_j+\tau_{ij}^r \right)+\frac{\partial \overline{p}}{\partial x_i}- \nu \frac{\partial^2\overline{u}_i}{\partial x_j^2} = \overline{F}_i.
\end{equation}
We use this formulation because $\tau_{ij}^r$ is traceless; it contains one less independent component than $\tau_{ij}^R$. A \emph{subgrid scale model} is a model for $\tau_{ij}^r$.
\section{Two-Dimensional Subgrid models}
Assume we are in two-dimensions (i.e.\ $u_3=0$). We rewrite the \eq{barsNS}, dropping the bars for convenience.
\begin{equation}\label{filteredNS}
\frac{\partial {u}_i}{\partial t} =- \frac{\partial }{\partial x_j}\left({u}_i{u}_j +\tau_{ij}^r\right)-\frac{\partial {p}}{\partial x_i}+ \nu \frac{\partial^2u_i}{\partial x_j^2} + {F}_i.
\end{equation}

We define the vorticity of the system to be $\boldsymbol{\omega} = \boldsymbol{\nabla}\times\boldsymbol{u}$. In two-dimensions, $\omega:= \omega_3$ is the only non-zero component of the vorticity. Our goal is to obtain an equation for how $\omega$ evolves in time. We have:
$$\frac{\partial \omega}{\partial t}   =  \frac{\partial }{\partial t}\left(\frac{\partial u_2}{\partial x_1} -\frac{\partial u_1}{\partial x_2} \right)=  \frac{\partial }{\partial x_1}\frac{\partial u_2}{\partial t} -\frac{\partial }{\partial x_2}\frac{\partial u_1}{\partial t}.$$
We can use \eq{filteredNS} to obtain expressions for ${\partial u_1}/{\partial t}$ and ${\partial u_2}/{\partial t}$. This gives us:
\begin{align*}
\frac{\partial \omega}{\partial t} &= \frac{\partial }{\partial x_1}\left[- \frac{\partial }{\partial x_j}\left({u}_2{u}_j +\tau_{2j}^r\right)-\cancel{\frac{\partial {p}}{\partial x_2}}+  \nu \frac{\partial^2u_2}{\partial x_j^2}+ {F}_2\right]-\frac{\partial }{\partial x_2}\left[- \frac{\partial }{\partial x_j}\left({u}_1{u}_j +\tau_{1j}^r\right)-\cancel{\frac{\partial {p}}{\partial x_1}}+ \nu \frac{\partial^2u_1}{\partial x_j^2}+ {F}_1\right]\\
&= \frac{\partial }{\partial x_j}\left[ \frac{\partial }{\partial x_2}\left({u}_1{u}_j +\tau_{1j}^r\right) - \frac{\partial }{\partial x_1}\left({u}_2{u}_j +\tau_{2j}^r\right)\right] +\nu \frac{\partial^2}{\partial x_j^2}\left(\frac{\partial u_2}{\partial x_1} -\frac{\partial u_1}{\partial x_2}\right) +\frac{\partial F_2}{\partial x_1} -\frac{\partial F_1}{\partial x_2}\\
&= \frac{\partial^2 }{\partial x_1\partial x_2}\left({u}_1^2 +\tau_{11}^r\right) - \frac{\partial^2 }{\partial x_1^2}\left({u}_2{u}_1 +\tau_{21}^r\right)+\frac{\partial^2 }{\partial x_2^2}\left({u}_1{u}_2 +\tau_{12}^r\right) - \frac{\partial^2 }{\partial x_1\partial x_2}\left({u}_2^2+\tau_{22}^r\right) +\nu \frac{\partial^2\omega}{\partial x_j^2}+\frac{\partial F_2}{\partial x_1} -\frac{\partial F_1}{\partial x_2}.
\end{align*}
Recall that the anisotropic stress tensor is symmetric and traceless, so we have $\tau_{12}^r=\tau_{21}^r$ and $\tau_{11}^r = -\tau_{22}^r$. This gives us
$$\frac{\partial \omega}{\partial t} = \frac{\partial^2 }{\partial x_1\partial x_2}\left({u}_1^2 -{u}_2^2+2\tau_{11}^r\right) +\left(\frac{\partial^2 }{\partial x_2^2} - \frac{\partial^2 }{\partial x_1^2}\right)\left({u}_1{u}_2 +\tau_{12}^r\right) +\nu \frac{\partial^2\omega}{\partial x_j^2}+\frac{\partial F_2}{\partial x_1} -\frac{\partial F_1}{\partial x_2}.$$
Now define $A(\boldsymbol{x}, t)  := u_2^2-u_1^2- 2\tau_{11}^r$ and $B(\boldsymbol{x}, t) :=u_1u_2 + \tau_{12}^r$. Rearranging the terms, we can write the vorticity equation as:
\begin{equation}\label{vortB}
\frac{\partial \omega}{\partial t}  + \frac{\partial^2 }{\partial x_1\partial x_2}A(\boldsymbol{x}, t) + \left(\frac{\partial^2}{\partial x_1^2} - \frac{\partial^2}{\partial x_2^2}\right)B(\boldsymbol{x}, t) = \nu{\nabla}^2\omega+\frac{\partial F_2}{\partial x_1} - \frac{\partial F_1}{\partial x_2} .
\end{equation}
Notice that \eq{vortB} is quite general. It makes no assumptions about the type of model we are using. 
\section{The Smagorinsky model}
\subsection{Theory}
In large eddy simulations, the filtered Navier--Stokes equation includes the anisotropic residual stress tensor. This tensor requires a model (known as a subgrid scale model). The first such model is known as the Smagorinsky model.

First proposed by Joseph Smagorinsky in 1963, the model was initially used to study the dynamics of atmospheric circulation \cite{Smagorinsky1963}. While considered to be one of the simplest of subgrid scale models, it forms the basis for many more advanced  models. 

The Smagorinsky model assumes the linear turbulent viscosity model:
$$\tau_{ij}^r = -2\nu_t {S}_{ij},$$
where $\nu_t$ is the turbulent viscosity and $S_{ij}$ is the rate of strain tensor:
$${S}_{ij} := \frac{1}{2}\left( \frac{\partial {u}_i}{\partial x_j} + \frac{\partial {u}_j}{\partial x_i}\right).$$
To find $\tau_{ij}^r$, we need to find $\nu_t$. The turbulent viscosity is assumed to be given by
$$\nu_t = (C_s \Delta)^2 {S},$$
where $C_s$ is the Smagorinsky coefficient, $\Delta$ is the filter width, and ${S}$ is the characteristic filtered rate of strain:
$${S} := \left(2{S}_{ij}{S}_{ij}\right)^{1/2}$$
This can be written out as:
$${S} = \left[\frac{1}{2}\left( \frac{\partial {u}_i}{\partial x_j} + \frac{\partial {u}_j}{\partial x_i}\right)\left( \frac{\partial {u}_i}{\partial x_j} + \frac{\partial {u}_j}{\partial x_i}\right)\right]^{1/2} = \left[\frac{1}{2}\left( \frac{\partial {u}_1}{\partial x_1}\right)^2+\left( \frac{\partial {u}_2}{\partial x_1} + \frac{\partial {u}_1}{\partial x_2}\right)^2+\frac{1}{2}\left( \frac{\partial {u}_2}{\partial x_2}\right)^2 \right]^{1/2}.$$
So the anisotropic stress tensor is given by
\begin{equation}
\tau_{ij}^r = -(C_s \Delta)^2\left[2\left( \frac{\partial {u}_1}{\partial x_1}\right)^2+4\left( \frac{\partial {u}_2}{\partial x_1} + \frac{\partial {u}_1}{\partial x_2}\right)^2+2\left( \frac{\partial {u}_2}{\partial x_2}\right)^2 \right]^{1/2}{S}_{ij}.
\end{equation}
Using the fact that the fluid is incompressible, i.e.\ $\frac{\partial {u}_1}{\partial x_1} = -\frac{\partial {u}_2}{\partial x_2}$, we can simplify this equation as:
\begin{equation}\label{smagTau}
\tau_{ij}^r = -2(C_s \Delta)^2\left[\left( \frac{\partial {u}_1}{\partial x_1}\right)^2+\left( \frac{\partial {u}_2}{\partial x_1} + \frac{\partial {u}_1}{\partial x_2}\right)^2 \right]^{1/2}{S}_{ij}.
\end{equation}
\subsection{In Two Dimensions}
From \eq{vortB}, we see that we only have to compute $\tau^r_{11}$ and $\tau^r_{12}$. We have 
$${S}_{11} = \frac{\partial {u}_1}{\partial x_1},$$
and
$${S}_{12} = \frac{1}{2}\left( \frac{\partial {u}_1}{\partial x_2} + \frac{\partial {u}_2}{\partial x_1}\right).$$
So we have
\begin{equation}\label{tau11}
\tau_{11}^r= -2(C_s \Delta)^2\left[\left( \frac{\partial {u}_1}{\partial x_1}\right)^2+\left( \frac{\partial {u}_2}{\partial x_1} + \frac{\partial {u}_1}{\partial x_2}\right)^2 \right]^{1/2}\left(\frac{\partial {u}_1}{\partial x_1}\right),
\end{equation}
and
\begin{equation}\label{tau12}
\tau_{12}^r= -(C_s \Delta)^2\left[\left( \frac{\partial {u}_1}{\partial x_1}\right)^2+\left( \frac{\partial {u}_2}{\partial x_1} + \frac{\partial {u}_1}{\partial x_2}\right)^2 \right]^{1/2}\left( \frac{\partial {u}_1}{\partial x_2} + \frac{\partial {u}_2}{\partial x_1}\right).
\end{equation}
The vorticity equation, with the Smagorinsky subgrid model, is then given by \eq{vortB}, where
$$A(\boldsymbol{x}, t) = u_2^2 - u_1^2 + 4(C_s \Delta)^2\left[\left( \frac{\partial {u}_1}{\partial x_1}\right)^2+\left( \frac{\partial {u}_2}{\partial x_1} + \frac{\partial {u}_1}{\partial x_2}\right)^2 \right]^{1/2}\left(\frac{\partial {u}_1}{\partial x_1}\right),$$
and
$$B(\boldsymbol{x}, t) = u_1u_2 -(C_s \Delta)^2\left[\left( \frac{\partial {u}_1}{\partial x_1}\right)^2+\left( \frac{\partial {u}_2}{\partial x_1} + \frac{\partial {u}_1}{\partial x_2}\right)^2 \right]^{1/2}\left( \frac{\partial {u}_1}{\partial x_2} + \frac{\partial {u}_2}{\partial x_1}\right).$$
The advantage of writing the equation in this form is that in a two-dimensional pseudospectral simulation (such as \text{\tt{protodns}}), $A(\boldsymbol{x},t)$ and $B(\boldsymbol{x},t)$ simply take the place of $u_2^2 - u_1^2$ and $u_1u_2$ respectively. This, however, will require at least 2 additional inverse FFTs.
\bibliographystyle{plain}
\clearpage
\bibliography{refs}
\end{document}
