\documentclass[12pt]{article}
\usepackage[dvips]{attachfile2}
\usepackage{math}

\begin{document}

\topmargin=-1in

\title{Efficient Dealiasing of Fast Fourier-Transform Convolutions}
\author{John C. Bowman and Malcolm Roberts}
\maketitle

Suppose $N$ is a multiple of $2$. In terms of the $N$th primitive root of unity,
$$
\zeta_N\doteq \exp\(\frac{2 \pi i}{N}\),
$$
the discrete inverse Fourier transform may be written
$$
u_j=\sum_{k=0}^{N-1}\zeta_N^{jk} \hat u_k\qquad j=0,\ldots,N-1.
$$
Notice that $\zeta_N^2=\zeta_{N/2}$ and $\zeta_N^N=1$.

If $\hat u_k=0$ for $k \ge N/2$ then
\be
u_{2\ell}
=\ds\sum_{k=0}^{N/2-1}\zeta_{N/2}^{\ell k} \hat u_k
%=\ds\sum_{m=0}^{N/4-1}\zeta_{N/2}^{2\ell m} \hat u_{2m}+
%\zeta_N^{2\ell}\sum_{m=0}^{N/4-1}\zeta_{N/2}^{2\ell m} \hat u_{2m+1}.
\ee

Likewise,
\be
u_{2\ell+1}
=\ds\sum_{k=0}^{N/2-1}\zeta_{N/2}^{\ell k} \zeta_N^k\hat u_k
%=\ds\sum_{m=0}^{N/4-1}\zeta_{N/2}^{2\ell m} \zeta_N^{2m}\hat u_{2m}
%+\zeta_N^{2\ell+1}\sum_{m=0}^{N/4-1}\zeta_{N/2}^{2\ell m} \zeta_N^{2m}\hat u_{2m+1}
\ee

These terms need to be computed for $\ell=0,\ldots,N/2-1$.
So the scaling is $2\fr{N}{2}\log {N/2}=N\log(N/2)$.


The odd and even terms of the convolution can be separately computed,
multiplied term-by-term, and transformed back:
\bec
\hat u_k=\sum_{j=0}^{N-1}\zeta_N^{-kj} u_j
=\sum_{\ell=0}^{N/2-1}\zeta_N^{-2k\ell} u_{2\ell}
+\zeta_N^{-k}\sum_{\ell=0}^{N/2-1}\zeta_N^{-2k\ell} u_{2\ell+1}
\qquad k=0,\ldots,\fr{N}{2}-1.\\
\ee

We can therefore compute the convolution with two 1024 blocks (rather than one
2048 block), to get a dealiased 1024 convolution (with the 2/4 rule).

Also, this will work with complex to real transforms without modification,
since $\zeta_N^{-k}=\zeta_N^k{}^*$.

The convolution in the Navier--Stokes equations require a $2/3$ padding in
order to avoid problems with aliasing.  Suppose that the total number of modes
(including zero-padding) is $N=3m$.  The inverse discrete Fourier transform
is then
$$
u_j=\sum_{k=0}^{N-1}\zeta_N^{jk} \hat u_k
=\sum_{k=0}^{2m-1}\zeta_N^{jk} \hat u_k
$$
Then, 
\bel
u_{3\ell}= \sum_{k=0}^{2m-1}\z_{3m}^{3\ell k} \hat u_k
=\sum_{k=0}^{m-1}\z_{m}^{\ell k} \hat u_k
+\sum_{k=m}^{2m-1}\z_{m}^{\ell k} \hat u_k
=\sum_{k=0}^{m-1}\z_{m}^{\ell k} \hat u_k
+\sum_{k=0}^{m-1}\z_{m}^{\ell (k+m)} \hat u_{k+m}
=\sum_{k=0}^{m-1}\z_{m}^{\ell k} \(\hat u_k+\hat u_{k+m}\).\label{DFTm}
\eel
Equation~\ref{DFTm} is a DFT of length $m$,
each requiring $m\log m$ operations. Following a similar procedure,
with $r=1$ or $r=2$,
$$
u_{3\ell +r}\no=
 \sum_{k=0}^{m-1}\z_{m}^{\ell k} \z_N^k \(\hat u_k + \z_N^{rm}\hat u_{k+m}\)
$$
Thus, the total number of operations is $3 m \log m = N \log\frac{N}{3}$.

In general, consider a ``$p/q$'' padding in which $N=qm$, and only $pm$ modes
are non-zero, with $p$ and $q$ relatively prime. Consider $u_{q\ell+r}$, with
$\ell=0 \dots q-1$, $r=0 \dots m-1$.
Then,
\be
u_{q\ell+r} = \sum_{k=0}^{N-1}\z_N^{(q\ell+r)k} \hat u_k
= \sum_{k=0}^{mp-1}\z_{mq}^{(q\ell+r)k} \hat u_k
= \sum_{\a=0}^p \sum_{k=\a m}^{(\a+1)m-1}\z_{mq}^{(q\ell+r)k} \hat u_k
= \sum_{\a=0}^p \sum_{\k=0}^{m-1}\z_{mq}^{(q\ell+r)(\k+\a m)} \hat u_{\k+\a m}
= \sum_{\k=0}^{m-1}\z_m^{\ell\k}\z_N^{r\k} \sum_{\a=0}^p\z_N^{r \a m} \hat u_{\k+\a m}
\ee .
Note that, in the last line, we have the choice of which $\z$ to use, since
$\z_q^{r \a}=\z_N^{r \a m}$. Since there are $m$ choices of $r$ and $q$ choices
for $\ell$, we are left with $mq=N$ FFTs of length $p$, leaving on the order
of $N \log p = N \log (N/q)$ operations.  Again, while the computational cost
is not significantly increased, savings may be made in terms of memory use
and parallelizability.

%TODO: I think that this can be generalized in the following fashion:
%if $m$ of the $N$ modes are non-zero, let $p=N/\gcd(m,N)$. Then we
%have can divide up the DFT into $p$ DFTs of length $m$. Must work out
%the details.

\end{document}
